import{_ as E,d as N,r as v,C as g,w as R,e as i,j as S,o as U,h as a,f as l,p as j,i as q,n as V,Z as m}from"./index-ChCbqBtc.js";import"./lodash-DN9DU0YO.js";import{i as M}from"./index-BD3tVcmV.js";const T={class:"dialog-footer"},L={__name:"Edit",props:{visible:{type:Boolean,default:!1},dataItem:{type:Object,default:()=>({})}},emits:["update:visible","refresh-list"],setup(h,{emit:w}){const{proxy:O}=N(),s=h,p=w,c=v(!1),n=v(null),e=g({name:"",description:""}),y=g({name:[{required:!0,message:"请输入专题名称",trigger:"blur"},{min:2,message:"请输入2~10个字符",trigger:"blur"}]}),x=()=>{var t;(t=n.value)==null||t.resetFields(),e.name=""},u=()=>{p("update:visible",!1),x()},C=()=>{u()},I=()=>{e.name=s.dataItem.name,e.description=s.dataItem.description},k=async()=>{try{c.value=!0,M({id:s.dataItem.id,name:`${e.name}`,description:e.description}).then(t=>{const{code:o,msg:d}=t;o===200?(m.success("操作成功！"),u(),p("refresh-list")):m.error(""+d)})}catch{m.error("操作失败，请重试")}finally{setTimeout(()=>{c.value=!1},500)}},f=()=>{n.value&&n.value.validate(t=>{t?k():m.error("请检查表单输入")})};R(()=>s.visible,t=>{t&&I()},{immediate:!0});const B=()=>{f()};return(t,o)=>{const d=i("el-input"),_=i("el-form-item"),F=i("el-form"),b=i("el-button"),D=i("el-dialog");return U(),S(D,{title:"修改",modelValue:s.visible,"onUpdate:modelValue":o[2]||(o[2]=r=>s.visible=r),width:"660px","append-to-body":"","before-close":u},{footer:a(()=>[q("div",T,[l(b,{onClick:C},{default:a(()=>[V("取消")]),_:1}),l(b,{type:"primary",onClick:f,loading:c.value},{default:a(()=>[V(" 确定 ")]),_:1},8,["loading"])])]),default:a(()=>[l(F,{ref_key:"formRef",ref:n,model:e,rules:y,"label-width":"100px",onSubmit:j(B,["prevent"])},{default:a(()=>[l(_,{label:"专题名称",prop:"name"},{default:a(()=>[l(d,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=r=>e.name=r),placeholder:"请输入专题名称","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(_,{label:"描述",prop:"description"},{default:a(()=>[l(d,{modelValue:e.description,"onUpdate:modelValue":o[1]||(o[1]=r=>e.description=r),placeholder:"请输入描述","show-word-limit":"",type:"textarea",rows:"10"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}},A=E(L,[["__scopeId","data-v-e93b30b7"]]);export{A as default};
