import{_ as F,d as B,r as v,C as g,w as E,e as s,j as R,o as j,h as o,f as i,p as q,n as u,t as M,i as T,Z as m}from"./index-ChCbqBtc.js";import"./lodash-DN9DU0YO.js";import{e as U}from"./template-D_2TWKT_.js";import{e as $}from"./tool-CCETPaDm.js";const L={class:"dialog-footer"},O={__name:"Edit",props:{visible:{type:Boolean,default:!1},tableDataItem:{type:Object,default:()=>({})}},emits:["update:visible","refresh-list"],setup(x,{emit:N}){const{proxy:Z}=B(),l=x,p=N,n=v(!1),r=v(null),t=g({templateName:"",fileSuffix:""}),h=g({templateName:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:2,message:"请输入2~10个字符",trigger:"blur"}]}),y=()=>{var e;(e=r.value)==null||e.resetFields(),t.templateName=""},f=()=>{p("update:visible",!1),y()},S=()=>{f()},V=()=>{const{fileName:e,fileSuffix:a}=$(l.tableDataItem.templateName);t.templateName=e,t.fileSuffix=a},w=async()=>{try{n.value=!0,U({id:l.tableDataItem.id,templateName:`${t.templateName}.${t.fileSuffix}`}).then(e=>{const{code:a,msg:c}=e;a===200?(m.success("操作成功！"),f(),p("refresh-list")):m.error(""+c)})}catch{m.error("操作失败，请重试")}finally{setTimeout(()=>{n.value=!1},500)}},_=()=>{r.value&&r.value.validate(e=>{e?w():m.error("请检查表单输入")})};E(()=>l.visible,e=>{e&&V()},{immediate:!0});const D=()=>{_()};return(e,a)=>{const c=s("el-input"),C=s("el-form-item"),I=s("el-form"),b=s("el-button"),k=s("el-dialog");return j(),R(k,{title:"修改",modelValue:l.visible,"onUpdate:modelValue":a[1]||(a[1]=d=>l.visible=d),width:"660px","append-to-body":"","before-close":f},{footer:o(()=>[T("div",L,[i(b,{onClick:S},{default:o(()=>[u("取消")]),_:1}),i(b,{type:"primary",onClick:_,loading:n.value},{default:o(()=>[u(" 确定 ")]),_:1},8,["loading"])])]),default:o(()=>[i(I,{ref_key:"formRef",ref:r,model:t,rules:h,"label-width":"100px",onSubmit:q(D,["prevent"])},{default:o(()=>[i(C,{label:"模板名称",prop:"templateName"},{default:o(()=>[i(c,{modelValue:t.templateName,"onUpdate:modelValue":a[0]||(a[0]=d=>t.templateName=d),placeholder:"请输入模板名称","show-word-limit":""},{append:o(()=>[u("."+M(t.fileSuffix),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}},J=F(O,[["__scopeId","data-v-6b3574b4"]]);export{J as default};
