import{_ as G,r as g,C as N,w as J,e as m,c as R,o as i,f as s,h as n,n as h,l,D as T,j as v,k as q,H as j,K as I,L as $,I as L,E as P}from"./index-ChCbqBtc.js";import{i as Q}from"./index-B0pCpdg4.js";import{R as W,a as X,b as Y,c as Z}from"./template-D_2TWKT_.js";import{R as k}from"./index-BD3tVcmV.js";const ee={class:"flex flex-col flex-1 app-container app-container-iframe doc-gen"},te={__name:"index.old",setup(le){const C=g("http://localhost:8081/app/228fa08b-96e1-4861-acc3-b32a2ab09369/configuration"),b=g(!1),S=()=>{P.confirm("您确定要关闭这个对话框吗?").then(()=>{b.value=!1,F(V.value),y.value=[],u.templateId=""}).catch(()=>{})},V=g(),u=N({templateId:"",signature:"",mj:"",name:"",context:""}),c={signature:{label:"文件编号",type:"text",required:!0,rules:[{required:!0,message:"请输入文件编号",trigger:"blur"}]},mj:{label:"密级",type:"select",required:!0,rules:[{required:!0,message:"请选择密级",trigger:"blur"}],options:[{label:"密级★10年",value:"秘密10年"},{label:"密级★20年",value:"机密20年"},{label:"密级★30年",value:"绝密30年"}]},name:{label:"标题",type:"text",required:!0,rules:[{required:!0,message:"请输入标题",trigger:"blur"}]},context:{label:"正文内容",type:"textarea",required:!0,rules:[{required:!0,message:"请输入正文内容",trigger:"blur"}]}},B=N({});let y=g([]);J(y,o=>{const e={};o.forEach(a=>{var d;(d=c[a])!=null&&d.rules&&(e[a]=c[a].rules)}),Object.assign(B,e)},{immediate:!0});const w=g({}),A=async o=>{o&&await o.validate((e,a)=>{e?Y({templateId:u.templateId,data:u}).then(d=>{const{code:f,data:r,msg:_}=d;f===200&&(w.value=r)}):console.log("error submit!",a)})},F=o=>{o&&o.resetFields()};Array.from({length:1e4}).map((o,e)=>({value:`${e+1}`,label:`${e+1}`}));const U=g([]);(()=>{W({current:1,pageSize:100}).then(e=>{U.value=e.rows,console.log("templateOptions",U.value)})})();const E=()=>{Z().then(o=>{const{code:e,data:a,msg:d}=o;e===200&&(u.signature=a)})},z=o=>{X(o).then(e=>{const{code:a,data:d,msg:f}=e;if(a===200){console.log("templateBookmarkArr",d);const r=d.map(_=>_==="mj1"||_==="mj2"?"mj":_);return y.value=[...new Set(r)],E()}})};let x=g(!1);function H(o){x.value=!0,k({fileId:w.value.fileId}).then(e=>{const a=new Blob([e],{type:e.type||"application/octet-stream"});let d=w.value.fileName;const f=window.URL.createObjectURL(a),r=document.createElement("a");r.href=f,r.download=d,r.style.display="none",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(f),document.body.removeChild(r),setTimeout(()=>{x.value=!1},500)}).catch(()=>{setTimeout(()=>{x.value=!1},500)})}return(o,e)=>{const a=m("el-button"),d=m("el-option"),f=m("el-select"),r=m("el-form-item"),_=m("el-col"),O=m("el-row"),D=m("el-input"),K=m("el-form"),M=m("el-drawer");return i(),R("div",ee,[s(a,{type:"primary",class:"start-gen",onClick:e[0]||(e[0]=t=>b.value=!0)},{default:n(()=>[h(" 开始生成 ")]),_:1}),s(l(Q),{src:l(C),"onUpdate:src":e[1]||(e[1]=t=>T(C)?C.value=t:null)},null,8,["src"]),s(M,{modelValue:l(b),"onUpdate:modelValue":e[6]||(e[6]=t=>T(b)?b.value=t:null),title:"生成文书",direction:"ltr","before-close":S,size:"100%"},{default:n(()=>[s(K,{ref_key:"ruleFormRef",ref:V,style:{"max-width":"100%"},model:l(u),rules:l(B),"label-width":"auto","validate-on-rule-change":!1},{default:n(()=>[s(O,{gutter:20},{default:n(()=>[s(_,{span:12},{default:n(()=>[s(r,{label:"选择模板",prop:"templateId"},{default:n(()=>[s(f,{modelValue:l(u).templateId,"onUpdate:modelValue":e[2]||(e[2]=t=>l(u).templateId=t),placeholder:"请选择",onChange:z},{default:n(()=>[(i(!0),R(I,null,$(l(U),(t,p)=>(i(),v(d,{key:`templateName-${p}`,label:t.templateName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(y).length?(i(),v(O,{key:0,gutter:20},{default:n(()=>[(i(!0),R(I,null,$(l(y),t=>(i(),v(_,{key:t,span:c[t].type==="textarea"?24:12},{default:n(()=>[s(r,{label:c[t].label,prop:t},{default:n(()=>[c[t].type==="text"?(i(),v(D,{key:0,modelValue:l(u)[t],"onUpdate:modelValue":p=>l(u)[t]=p,placeholder:`请输入${c[t].label}`},null,8,["modelValue","onUpdate:modelValue","placeholder"])):q("",!0),c[t].type==="select"?(i(),v(f,{key:1,modelValue:l(u)[t],"onUpdate:modelValue":p=>l(u)[t]=p,placeholder:`请选择${c[t].label}`},{default:n(()=>[(i(!0),R(I,null,$(c[t].options,p=>(i(),v(d,{key:p.value,label:p.label,value:p.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):q("",!0),c[t].type==="textarea"?(i(),v(D,{key:2,modelValue:l(u)[t],"onUpdate:modelValue":p=>l(u)[t]=p,type:"textarea",rows:4,placeholder:`请输入${c[t].label}`},null,8,["modelValue","onUpdate:modelValue","placeholder"])):q("",!0)]),_:2},1032,["label","prop"])]),_:2},1032,["span"]))),128))]),_:1})):q("",!0),j(s(r,null,{default:n(()=>[s(a,{type:"primary",onClick:e[3]||(e[3]=t=>A(l(V)))},{default:n(()=>[h(" 生成 ")]),_:1}),s(a,{onClick:e[4]||(e[4]=t=>F(l(V)))},{default:n(()=>[h("重置")]),_:1}),j(s(a,{type:"info"},{default:n(()=>[h(" 预览 ")]),_:1},512),[[L,Object.keys(l(w)).length]]),j(s(a,{type:"success",onClick:e[5]||(e[5]=t=>H()),loading:l(x)},{default:n(()=>[h(" 下载 ")]),_:1},8,["loading"]),[[L,Object.keys(l(w)).length]])]),_:1},512),[[L,l(y).length]])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}},ue=G(te,[["__scopeId","data-v-3b6ad566"]]);export{ue as default};
