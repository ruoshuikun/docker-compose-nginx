import{T as _,_ as j,d as A,r as y,C as q,z as B,w as F,e as i,j as T,o as M,h as l,f as r,p as N,i as O,n as h,Z as m}from"./index-ChCbqBtc.js";import{l as U}from"./lodash-DN9DU0YO.js";function z(a){return _({url:"/server/answer",method:"post",data:a})}function L(a){return _({url:"/server/answer",method:"put",data:a})}function K(a){return _({url:"/server/answer/list",method:"get",params:a})}const P={class:"dialog-footer"},Z={__name:"AddEdit",props:{visible:{type:Boolean,default:!1},tableDataItem:{type:Object,default:()=>({})},type:{type:String,default:"add"}},emits:["update:visible","refresh-list"],setup(a,{emit:V}){const{proxy:G}=A(),s=a,b=V,w=y(!1),d=y(null),t=q({question:"",answer:""}),x=q({question:[{required:!0,message:"请输入问题",trigger:"blur"}],answer:[{required:!0,message:"请输入回答",trigger:"blur"}]}),D=B(()=>s.type==="add"?"新增":"修改"),C=()=>{var e;(e=d.value)==null||e.resetFields(),t.question=""},p=()=>{b("update:visible",!1),C()},R=()=>{p()},S=()=>{if(s.title==="add")t.question="",t.answer="";else{const e=U.cloneDeep(s.tableDataItem);t.question=e.question,t.answer=e.answer}},k=async()=>{try{const e=s.type==="add"?z:L;console.log("api",e);let o={question:t.question,answer:t.answer};s.type==="add"?o=[o]:o.id=s.tableDataItem.id,console.log("data",o),e(o).then(u=>{const{code:c,msg:f}=u;c===200?(m.success("操作成功！"),p(),b("refresh-list")):m.error(""+f)})}catch{m.error("操作失败，请重试")}finally{setTimeout(()=>{w.value=!1},500)}},v=()=>{d.value&&d.value.validate(e=>{e?k():m.error("请检查表单输入")})};F(()=>s.visible,e=>{e&&S()},{immediate:!0});const E=()=>{v()};return(e,o)=>{const u=i("el-input"),c=i("el-form-item"),f=i("el-form"),g=i("el-button"),I=i("el-dialog");return M(),T(I,{title:D.value,modelValue:s.visible,"onUpdate:modelValue":o[2]||(o[2]=n=>s.visible=n),width:"660px","append-to-body":"","before-close":p},{footer:l(()=>[O("div",P,[r(g,{onClick:R},{default:l(()=>[h("取消")]),_:1}),r(g,{type:"primary",onClick:v,loading:w.value},{default:l(()=>[h(" 确定 ")]),_:1},8,["loading"])])]),default:l(()=>[r(f,{ref_key:"formRef",ref:d,model:t,rules:x,"label-width":"100px",onSubmit:N(E,["prevent"])},{default:l(()=>[r(c,{label:"问题",prop:"question"},{default:l(()=>[r(u,{modelValue:t.question,"onUpdate:modelValue":o[0]||(o[0]=n=>t.question=n),placeholder:"请输入问题","show-word-limit":""},null,8,["modelValue"])]),_:1}),r(c,{label:"回答",prop:"answer"},{default:l(()=>[r(u,{modelValue:t.answer,"onUpdate:modelValue":o[1]||(o[1]=n=>t.answer=n),placeholder:"请输入回答","show-word-limit":"",type:"textarea",rows:"10"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}},$=j(Z,[["__scopeId","data-v-3d5a2ece"]]),Q=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"}));export{$ as A,K as R,Q as a};
