# ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“‹ **ç¯å¢ƒè¦æ±‚**

- **æ“ä½œç³»ç»Ÿ**: CentOS 7+, Ubuntu 18.04+, æˆ–å…¶ä»–æ”¯æŒ Docker çš„ Linux ç³»ç»Ÿ
- **Docker**: ç‰ˆæœ¬ 20.10+
- **Docker Compose**: ç‰ˆæœ¬ 1.29+
- **æƒé™**: sudo æƒé™ï¼ˆç”¨äºå®‰è£…å’Œé…ç½®ï¼‰

## âš¡ **5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²**

### 1. æœ¬åœ°éƒ¨ç½²

```bash
# å…‹éš†é¡¹ç›®
git clone <é¡¹ç›®åœ°å€>
cd nginx-template

# å¯åŠ¨æœåŠ¡ï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºç›®å½•å’Œé…ç½®ï¼‰
./nginx-manager.sh start

# éƒ¨ç½²ç¬¬ä¸€ä¸ªé¡¹ç›®
./nginx-manager.sh deploy web /path/to/your/dist

# æŸ¥çœ‹éƒ¨ç½²ç»“æœ
./nginx-manager.sh list
./nginx-manager.sh status
```

**è®¿é—®åœ°å€**: http://localhost/web/

### 2. è¿œç¨‹æœåŠ¡å™¨éƒ¨ç½²

```bash
# ä¸€é”®éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨
./scripts/remote-deploy.sh 192.168.1.100 root web /path/to/your/dist

# è®¿é—®æœåŠ¡å™¨ä¸Šçš„åº”ç”¨
curl http://192.168.1.100/web/
```

## ğŸ¯ **å¸¸ç”¨å‘½ä»¤**

### åŸºç¡€æ“ä½œ

```bash
./nginx-manager.sh start        # å¯åŠ¨æœåŠ¡
./nginx-manager.sh stop         # åœæ­¢æœåŠ¡
./nginx-manager.sh restart      # é‡å¯æœåŠ¡
./nginx-manager.sh status       # æŸ¥çœ‹çŠ¶æ€
./nginx-manager.sh logs         # æŸ¥çœ‹æ—¥å¿—
```

### é¡¹ç›®ç®¡ç†

```bash
# éƒ¨ç½²é¡¹ç›®
./nginx-manager.sh deploy web /path/to/web-dist
./nginx-manager.sh deploy admin /path/to/admin-dist
./nginx-manager.sh deploy mobile /path/to/mobile-dist

# æŸ¥çœ‹é¡¹ç›®
./nginx-manager.sh list

# åˆ é™¤é¡¹ç›®
./nginx-manager.sh remove old-project

# å¤‡ä»½é¡¹ç›®
./nginx-manager.sh backup web
```

### é…ç½®ç®¡ç†

```bash
./nginx-manager.sh test         # æµ‹è¯•é…ç½®
./nginx-manager.sh reload       # é‡æ–°åŠ è½½é…ç½®
./nginx-manager.sh edit         # ç¼–è¾‘é…ç½®æ–‡ä»¶
```

### ç³»ç»Ÿç»´æŠ¤

```bash
./nginx-manager.sh health       # å¥åº·æ£€æŸ¥
./nginx-manager.sh clean        # æ¸…ç†ç³»ç»Ÿ
```

## ğŸ“ **é¡¹ç›®ç»“æ„è¯´æ˜**

éƒ¨ç½²åçš„ç›®å½•ç»“æ„ï¼š

```
nginx/html/
â”œâ”€â”€ web/                    # ä¸»é¡¹ç›®
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ libs/
â”‚   â””â”€â”€ favicon.ico
â”œâ”€â”€ admin/                  # ç®¡ç†åå°
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ assets/
â”‚   â””â”€â”€ favicon.ico
â””â”€â”€ mobile/                 # ç§»åŠ¨ç«¯é¡¹ç›®
    â”œâ”€â”€ index.html
    â””â”€â”€ assets/
```

**è®¿é—®æ–¹å¼**ï¼š
- ä¸»é¡¹ç›®: http://åŸŸå/web/
- ç®¡ç†åå°: http://åŸŸå/admin/
- ç§»åŠ¨ç«¯: http://åŸŸå/mobile/
- æ ¹ç›®å½•: http://åŸŸå/ ï¼ˆè‡ªåŠ¨è·³è½¬åˆ° /web/ï¼‰

## âš™ï¸ **é…ç½®è¯´æ˜**

### ç¯å¢ƒå˜é‡é…ç½® (.env)

```bash
# åŸºç¡€é…ç½®
NGINX_PORT=80                    # æœåŠ¡ç«¯å£
DEFAULT_PROJECT=web              # é»˜è®¤é¡¹ç›®

# API ä»£ç†é…ç½®
API_BACKEND_HOST=10.8.0.18      # åç«¯æœåŠ¡å™¨
API_BACKEND_PORT=8086           # åç«¯ç«¯å£

# æ€§èƒ½é…ç½®
CLIENT_MAX_BODY_SIZE=100M       # æœ€å¤§ä¸Šä¼ å¤§å°
ENABLE_GZIP=true                # å¯ç”¨å‹ç¼©
```

### Nginx é…ç½®æ–‡ä»¶

ä¸»é…ç½®æ–‡ä»¶ä½äº: `nginx/conf.d/default.conf`

å¦‚éœ€ä¿®æ”¹é…ç½®ï¼š
```bash
./nginx-manager.sh edit         # ç¼–è¾‘é…ç½®
./nginx-manager.sh test         # æµ‹è¯•é…ç½®
./nginx-manager.sh reload       # é‡æ–°åŠ è½½
```

## ğŸ”§ **æ•…éšœæ’æŸ¥**

### å¸¸è§é—®é¢˜

**1. æœåŠ¡å¯åŠ¨å¤±è´¥**
```bash
# æ£€æŸ¥ Docker çŠ¶æ€
sudo systemctl status docker

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
./nginx-manager.sh logs

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :80
```

**2. é¡¹ç›®è®¿é—® 404**
```bash
# æ£€æŸ¥é¡¹ç›®æ˜¯å¦éƒ¨ç½²
./nginx-manager.sh list

# æ£€æŸ¥ nginx é…ç½®
./nginx-manager.sh test

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
./nginx-manager.sh logs
```

**3. API ä»£ç†å¤±è´¥**
```bash
# æ£€æŸ¥åç«¯æœåŠ¡å™¨è¿é€šæ€§
curl http://API_BACKEND_HOST:API_BACKEND_PORT/api/health

# æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„ä»£ç†è®¾ç½®
./nginx-manager.sh edit
```

### è·å–å¸®åŠ©

```bash
# æŸ¥çœ‹å®Œæ•´å¸®åŠ©
./nginx-manager.sh help

# æŸ¥çœ‹è¿œç¨‹éƒ¨ç½²å¸®åŠ©
./scripts/remote-deploy.sh
```

## ğŸ“ **ç²¾ç®€åçš„é¡¹ç›®ç»“æ„**

```
nginx-template/
â”œâ”€â”€ nginx-manager.sh              # ğŸ¯ ä¸»ç®¡ç†è„šæœ¬
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ remote-deploy.sh          # ğŸš€ è¿œç¨‹éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ nginx/
â”‚   â”œâ”€â”€ conf.d/                   # Nginx é…ç½®
â”‚   â”œâ”€â”€ html/                     # ç½‘ç«™æ–‡ä»¶
â”‚   â”œâ”€â”€ logs/                     # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ ssl/                      # SSL è¯ä¹¦
â”œâ”€â”€ env.example                   # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ docker-compose.yml            # Docker ç¼–æ’é…ç½®
â””â”€â”€ å¿«é€Ÿå¼€å§‹æŒ‡å—.md               # ğŸ“– ä½¿ç”¨æŒ‡å—
```

## ğŸŒŸ **æœ€ä½³å®è·µ**

### 1. é¡¹ç›®å‘½åè§„èŒƒ

- **web**: ä¸»ç«™
- **admin**: ç®¡ç†åå°
- **mobile**: ç§»åŠ¨ç«¯
- **api**: API æ–‡æ¡£ç«™
- **demo**: æ¼”ç¤ºé¡¹ç›®

### 2. å¼€å‘å·¥ä½œæµ

```bash
# å¼€å‘é˜¶æ®µ
npm run build                               # æ„å»ºé¡¹ç›®
./nginx-manager.sh deploy web ./dist       # æœ¬åœ°éƒ¨ç½²æµ‹è¯•

# ç”Ÿäº§éƒ¨ç½²
./scripts/remote-deploy.sh ç”Ÿäº§æœåŠ¡å™¨IP root web ./dist
```

### 3. å¤šç¯å¢ƒç®¡ç†

```bash
# æµ‹è¯•ç¯å¢ƒ
./scripts/remote-deploy.sh test-server.com root web ./dist

# ç”Ÿäº§ç¯å¢ƒ
./scripts/remote-deploy.sh prod-server.com root web ./dist
```

### 4. å¤‡ä»½ç­–ç•¥

```bash
# éƒ¨ç½²å‰è‡ªåŠ¨å¤‡ä»½
./nginx-manager.sh backup web

# å®šæœŸå¤‡ä»½ï¼ˆå¯å†™å…¥ crontabï¼‰
0 2 * * * cd /opt/nginx-template && ./nginx-manager.sh backup web
```

## ğŸ“ **æŠ€æœ¯æ”¯æŒ**

- **é…ç½®é—®é¢˜**: æŸ¥çœ‹ `é¡¹ç›®æ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ.md`
- **å¤šé¡¹ç›®ç®¡ç†**: æŸ¥çœ‹ `nginxé…ç½®ä¿®æ”¹æ“ä½œæŒ‡å—.md`
- **éƒ¨ç½²é—®é¢˜**: ä½¿ç”¨ `./nginx-manager.sh health` è¿›è¡Œæ£€æŸ¥

---

**ğŸ‰ æ­å–œï¼ä½ å·²ç»æŒæ¡äº† Nginx å¤šé¡¹ç›®éƒ¨ç½²çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚** 