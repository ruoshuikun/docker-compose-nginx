import{B as H,a as J,d as O,r as e,C as M,J as W,e as s,G as X,c as x,o as u,H as h,f as n,I as Y,l as a,h as o,m as Z,K as ee,L as te,j as w,n as m,D as C,t as le}from"./index-ChCbqBtc.js";import{R as ae,d as oe}from"./template-D_2TWKT_.js";import ne from"./Upload-Cf-gZSLS.js";import ie from"./Edit-D25K46nv.js";import{c as se}from"./tool-CCETPaDm.js";import{f as re}from"./index-BD3tVcmV.js";import"./lodash-DN9DU0YO.js";const pe=H({name:"Template"}),we=Object.assign(pe,{setup(ue){J();const{proxy:d}=O(),{sys_normal_disable:me}=d.useDict("sys_normal_disable"),{template_type:z}=d.useDict("template_type");e([]),e(!1);const S=e(!0),D=e(!0);e([]),e(!0),e(!0),e(0),e("");const U=e([]);e([]),e(!1),e(!1),e(!0),e(!1),e([]),e(!1),e(null),e(null);const q=M({form:{},queryParams:{pageNum:1,pageSize:10,roleName:void 0,roleKey:void 0,status:void 0}}),{form:de,rules:ce}=W(q),E=e([{prop:"templateName",label:"模板名称",align:"left"},{prop:"templateType",label:"模板类型",type:"filter",dictionary:"template_type"},{prop:"fileSize",label:"文件大小",type:"custom"},{prop:"uploadUser",label:"上传人"},{prop:"createTime",label:"上传时间"},{prop:"",label:"操作",type:"operation",width:300}]),T=e([]),r=e({total:0,pageNum:1,pageSize:10}),p=e({templateName:void 0,templateType:void 0});function f(){S.value=!0;let i={pageNum:r.value.pageNum,pageSize:r.value.pageSize,templateName:p.value.templateName,templateType:p.value.templateType};ae(i).then(l=>{l.rows.map(v=>{v.viewLoading=!1}),T.value=l.rows,r.value.total=l.total,S.value=!1})}function _(){r.value.pageNum=1,f()}function I(){U.value=[],d.resetForm("queryRef"),_()}function L(){y.value=!0}f();let y=e(!1);function $(i){i.loadingView=!0,re({file_path:i.path}).then(l=>{const{code:v,data:{pdf_url:g},msg:N}=l;v===200?window.open(g,"_blank"):d.$modal.msgError(""+N)}).finally(()=>{setTimeout(()=>{i.loadingView=!1},500)})}let R=e({}),b=e(!1);function P(i){R.value=i,b.value=!0}const B=i=>{d.$modal.confirm(`是否确认删除角色编号为${i.templateName}的数据项?`).then(function(){return oe(i.id)}).then(()=>{f(),d.$modal.msgSuccess("删除成功")}).catch(()=>{})};return(i,l)=>{const v=s("el-input"),g=s("el-form-item"),N=s("el-option"),K=s("el-select"),c=s("el-button"),F=s("el-form"),Q=s("el-col"),j=s("right-toolbar"),G=s("el-row"),A=s("Table"),k=X("hasPermi");return u(),x("div",null,[h(n(F,{model:a(p),ref:"queryRef",inline:!0,"label-width":"68px"},{default:o(()=>[n(g,{label:"模板名称",prop:"templateName"},{default:o(()=>[n(v,{modelValue:a(p).templateName,"onUpdate:modelValue":l[0]||(l[0]=t=>a(p).templateName=t),placeholder:"请输入模板名称",clearable:"",style:{width:"240px"},onKeyup:Z(_,["enter"])},null,8,["modelValue"])]),_:1}),n(g,{label:"模板类型",prop:"templateType"},{default:o(()=>[n(K,{modelValue:a(p).templateType,"onUpdate:modelValue":l[1]||(l[1]=t=>a(p).templateType=t),placeholder:"模板类型",clearable:"",style:{width:"240px"}},{default:o(()=>[(u(!0),x(ee,null,te(a(z),t=>(u(),w(N,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(g,null,{default:o(()=>[n(c,{type:"primary",icon:"Search",onClick:_},{default:o(()=>[m("搜索")]),_:1}),n(c,{icon:"Refresh",onClick:I},{default:o(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[Y,a(D)]]),n(G,{gutter:10,class:"mb8"},{default:o(()=>[n(Q,{span:1.5},{default:o(()=>[h((u(),w(c,{type:"primary",plain:"",icon:"Plus",onClick:L},{default:o(()=>[m("新增")]),_:1})),[[k,["system:role:add"]]])]),_:1}),n(j,{showSearch:a(D),"onUpdate:showSearch":l[2]||(l[2]=t=>C(D)?D.value=t:null),onQueryTable:f},null,8,["showSearch"])]),_:1}),n(A,{paginationData:a(r),"onUpdate:paginationData":l[3]||(l[3]=t=>C(r)?r.value=t:null),tableColumn:a(E),tableData:a(T),showIndex:!0,onGetTableData:f},{fileSize:o(({row:t})=>[m(le(a(se)(t.fileSize).formatted),1)]),operation:o(({row:t})=>[h((u(),w(c,{link:"",type:"primary",icon:"View",onClick:V=>$(t)},{default:o(()=>[m("预览 ")]),_:2},1032,["onClick"])),[[k,["system:sensitive:update"]]]),h((u(),w(c,{link:"",type:"primary",icon:"Edit",onClick:V=>P(t)},{default:o(()=>[m("修改 ")]),_:2},1032,["onClick"])),[[k,["system:sensitive:update"]]]),h((u(),w(c,{link:"",type:"danger",icon:"Delete",onClick:V=>B(t)},{default:o(()=>[m(" 删除 ")]),_:2},1032,["onClick"])),[[k,["system:sensitive:delete"]]])]),_:1},8,["paginationData","tableColumn","tableData"]),n(ne,{visible:a(y),"onUpdate:visible":l[4]||(l[4]=t=>C(y)?y.value=t:y=t),onRefreshList:_},null,8,["visible"]),n(ie,{visible:a(b),"onUpdate:visible":l[5]||(l[5]=t=>C(b)?b.value=t:b=t),onRefreshList:_,tableDataItem:a(R)},null,8,["visible","tableDataItem"])])}}});export{we as default};
