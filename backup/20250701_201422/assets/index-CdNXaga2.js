import{_ as Fe,B as Oe,a as Pe,ag as Me,d as Qe,r as d,w as ee,e as u,G as Ge,c as q,o as k,f as e,i as S,h as a,l as n,D as _,p as U,t as te,j as O,k as le,ah as ae,ai as He,aj as Ze,ak as Je,n as p,H as w,m as oe,K as ne,L as de,I as We,Z as ie}from"./index-ChCbqBtc.js";import{b as Xe,c as Ye,d as et,e as tt,f as lt,R as at,g as ot}from"./index-BD3tVcmV.js";import{M as nt,g as se}from"./splitpanes-CAxx5xp1.js";import dt from"./AddEditFolder-CXXlCErK.js";import it from"./Upload-KdShldsj.js";import st from"./CreateKnowledgeBase-BQMPtuP-.js";import rt from"./AddKnowledgeBase-Dk5HdOri.js";import ut from"./Edit-DZGcYL0Z.js";import{c as ct}from"./tool-CCETPaDm.js";import"./lodash-DN9DU0YO.js";const pt={class:"head-container"},ft={class:"head-container"},mt={class:"custom-tree-node"},_t=["onClick"],vt={key:1},bt={class:"flex flex-col justify-end items-start custom-affix"},gt=Oe({name:"Document"}),ht=Object.assign(gt,{setup(yt){Pe();const re=Me(),{proxy:v}=Qe(),{import_knowledge_base:ue,sync_state:kt}=v.useDict("import_knowledge_base","sync_state"),ce=[];d(!1);const P=d(!0),$=d(!0);d([]),d(!0),d(!0);const pe=d([]),M=d(void 0),z=d(""),fe=d([{prop:"title",label:"文件名称",width:300,align:"left",fixed:"left"},{prop:"filetype",label:"文件类型",width:100},{prop:"sizeofraw",label:"文件大小",type:"custom",width:100},{prop:"uploaduser",label:"上传人",width:100},{prop:"word",label:"导入知识库状态",width:150},{prop:"createTime",label:"上传时间",width:100},{prop:"fulltext",label:"正文",type:"longText",width:250},{prop:"",label:"操作",type:"operation",width:230,align:"right",fixed:"right"}]),Q=d([]),N=d({}),C=d({total:0,pageNum:1,pageSize:10}),c=d({treeId:1});function R(){P.value=!0;const t={current:C.value.pageNum,pageSize:C.value.pageSize,foldid:c.value.treeId};Xe(t).then(l=>{P.value=!1,l.data.records.map(s=>{s.viewLoading=!1}),Q.value=l.data.records,C.value.total=Number(l.data.total)})}R();let G=d([]);const me=t=>{console.log("tableSelectionChange",t),G.value=t},_e=(t,l)=>{},ve=(t,l,s)=>{},be=(t,l,s)=>{},ge=(t,l,s)=>{},he=(t,l,s,m)=>{},ye=(t,l,s,m)=>{et({id:t.data.id,parentId:l.data.id}).then(i=>{const{code:r,msg:B}=i;r===200?(ie.success(B),E()):ie.error(B||"操作失败")})},ke=(t,l,s)=>l.data.label==="Level two 3-1"?s!=="inner":!0,we=t=>!t.data.label.includes("根目录"),H=d(null);ee(z,t=>{v.$refs.treeRef.filter(t)});const Ce=(t,l)=>t?l.label.includes(t):!0;let g=d(void 0);function E(){Ye().then(t=>{M.value=t.data,Array.isArray(t.data)&&t.data.length&&(g.value=t.data[0])})}E();let D=d(!1),A=d("新增");function Z(t){A.value="新增",g.value=t,D.value=!0}function De(t){A.value="修改",g.value=t,D.value=!0}function xe(t){v.$modal.confirm(`是否确认删除目录名称为${t.label}的数据项?`).then(function(){return tt(t.id)}).then(()=>{E(),v.$modal.msgSuccess("删除成功")}).catch(()=>{})}d({});function Se(t){c.value.treeId=t.id,g.value=t,h()}function Ne(t){}let J=d([]);const Re=(t,l,s)=>{console.log(t,l,s),J.value=Ie()},Ie=()=>{var t;return(t=H.value)==null?void 0:t.getCheckedNodes(!1,!1)};function h(){c.value.pageNum=1,R()}function Ve(){pe.value=[],v.resetForm("queryRef"),c.value.deptId=void 0,v.$refs.deptTreeRef.setCurrentKey(null),h()}function Te(t){at({fileId:t.fileid}).then(l=>{const s=new Blob([l],{type:l.type||"application/octet-stream"});let m=t.title;const i=window.URL.createObjectURL(s),r=document.createElement("a");r.href=i,r.download=m,r.style.display="none",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(i),document.body.removeChild(r)})}function Le(t){t.viewLoading=!0,lt({file_path:t.url}).then(l=>{const{code:s,data:{pdf_url:m},msg:i}=l;s===200?window.open(m,"_blank"):v.$modal.msgError(""+i)}).finally(()=>{setTimeout(()=>{t.viewLoading=!1},500)})}let I=d(!1);function Ue(t){N.value=t,I.value=!0}let j=d("");function $e(t){N.value=t,j.value="operation",b.value=!0}function ze(t){v.$modal.confirm(`是否确认删除用户编号为${t.title}的数据项？`).then(function(){return ot(t.id)}).then(()=>{R(),v.$modal.msgSuccess("删除成功")}).catch(()=>{})}let V=d(!1);function Ee(){V.value=!0}let y=d(!1),b=d(!1);return ee(()=>b.value,t=>{t||(N.value=[],j.value="")}),(t,l)=>{const s=u("el-input"),m=u("el-icon"),i=u("el-button"),r=u("el-dropdown-item"),B=u("el-dropdown-menu"),Be=u("el-dropdown"),Ke=u("el-tree"),F=u("el-col"),T=u("el-form-item"),W=u("el-option"),X=u("el-select"),qe=u("el-form"),Ae=u("right-toolbar"),Y=u("el-row"),L=u("el-tooltip"),je=u("Table"),x=Ge("hasPermi");return k(),q("div",null,[e(Y,{gutter:20},{default:a(()=>[e(n(nt),{horizontal:n(re).device==="mobile",class:"default-theme"},{default:a(()=>[e(n(se),{size:"24"},{default:a(()=>[e(F,null,{default:a(()=>[S("div",pt,[e(s,{modelValue:n(z),"onUpdate:modelValue":l[0]||(l[0]=o=>_(z)?z.value=o:null),placeholder:"请输入目录名称",clearable:"","prefix-icon":"Search",class:"mb-d"},null,8,["modelValue"])]),S("div",ft,[e(Ke,{ref_key:"treeRef",ref:H,style:{"max-width":"400px"},"allow-drop":ke,"allow-drag":we,data:n(M),draggable:"","default-expand-all":"","node-key":"id","show-checkbox":"","filter-node-method":Ce,onNodeDragStart:_e,onNodeDragEnter:ve,onNodeDragLeave:be,onNodeDragOver:ge,onNodeDragEnd:he,onNodeDrop:ye,onNodeClick:Ne,onCheckChange:Re},{default:a(({node:o,data:f})=>[S("div",mt,[S("span",{onClick:U(K=>Se(f),["stop"])},te(o.label),9,_t),S("div",null,[f.id===1?(k(),O(i,{key:0,type:"success",link:"",onClick:U(K=>Z(f),["stop"])},{default:a(()=>[e(m,{size:20},{default:a(()=>[e(n(ae))]),_:1})]),_:2},1032,["onClick"])):le("",!0),f.id!==1?(k(),q("div",vt,[e(Be,null,{dropdown:a(()=>[e(B,null,{default:a(()=>[e(r,{class:"flex justify-between"},{default:a(()=>[e(i,{type:"success",link:"",onClick:U(K=>Z(f),["stop"])},{default:a(()=>[e(m,{size:20},{default:a(()=>[e(n(ae))]),_:1})]),_:2},1032,["onClick"]),e(i,{style:{"margin-left":"4px"},type:"primary",link:"",onClick:U(K=>De(f),["stop"])},{default:a(()=>[e(m,{size:20},{default:a(()=>[e(n(Ze))]),_:1})]),_:2},1032,["onClick"]),e(i,{style:{"margin-left":"4px"},type:"danger",onClick:U(K=>xe(f),["stop"]),link:""},{default:a(()=>[e(m,{size:20},{default:a(()=>[e(n(Je))]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(r,{disabled:""},{default:a(()=>[p(" 查看图谱 ")]),_:1}),e(r,{disabled:""},{default:a(()=>[p(" 查看问答对 ")]),_:1}),e(r,{divided:""},{default:a(()=>[p(" 文书自动生成 ")]),_:1}),e(r,null,{default:a(()=>[p("发放计划生成")]),_:1}),e(r,null,{default:a(()=>[p("文书内容校对")]),_:1}),e(r,null,{default:a(()=>[p("冲突检测")]),_:1}),e(r,null,{default:a(()=>[p("空情态势")]),_:1})]),_:2},1024)]),default:a(()=>[e(i,{type:"primary",link:""},{default:a(()=>[e(m,{size:20},{default:a(()=>[e(n(He))]),_:1})]),_:1})]),_:2},1024)])):le("",!0)])])]),_:1},8,["data"])])]),_:1})]),_:1}),e(n(se),{size:"76"},{default:a(()=>[e(F,null,{default:a(()=>[w(e(qe,{model:n(c),ref:"queryRef",inline:!0,"label-width":"115px"},{default:a(()=>[e(T,{label:"文件名称",prop:"userName"},{default:a(()=>[e(s,{modelValue:n(c).userName,"onUpdate:modelValue":l[1]||(l[1]=o=>n(c).userName=o),placeholder:"请输入文件名称",clearable:"",style:{width:"240px"},onKeyup:oe(h,["enter"])},null,8,["modelValue"])]),_:1}),e(T,{label:"正文",prop:"phonenumber"},{default:a(()=>[e(s,{modelValue:n(c).phonenumber,"onUpdate:modelValue":l[2]||(l[2]=o=>n(c).phonenumber=o),placeholder:"请输入关键词",clearable:"",style:{width:"240px"},onKeyup:oe(h,["enter"])},null,8,["modelValue"])]),_:1}),e(T,{label:"上传人",prop:"status"},{default:a(()=>[e(X,{modelValue:n(c).status,"onUpdate:modelValue":l[3]||(l[3]=o=>n(c).status=o),placeholder:"请选择",clearable:"",style:{width:"240px"}},{default:a(()=>[(k(),q(ne,null,de(ce,o=>e(W,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(T,{label:"导入知识库状态",prop:"status"},{default:a(()=>[e(X,{modelValue:n(c).status,"onUpdate:modelValue":l[4]||(l[4]=o=>n(c).status=o),placeholder:"请选择",clearable:"",style:{width:"240px"}},{default:a(()=>[(k(!0),q(ne,null,de(n(ue),o=>(k(),O(W,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(T,null,{default:a(()=>[e(i,{type:"primary",icon:"Search",onClick:h},{default:a(()=>[p(" 搜索 ")]),_:1}),e(i,{icon:"Refresh",onClick:Ve},{default:a(()=>[p("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[We,n($)]]),e(Y,{gutter:10,class:"mb8"},{default:a(()=>[e(F,{span:1.5},{default:a(()=>[w((k(),O(i,{type:"primary",plain:"",icon:"Plus",onClick:Ee},{default:a(()=>[p("新增 ")]),_:1})),[[x,["document:list:add"]]])]),_:1}),e(Ae,{showSearch:n($),"onUpdate:showSearch":l[5]||(l[5]=o=>_($)?$.value=o:null),onQueryTable:R},null,8,["showSearch"])]),_:1}),e(je,{paginationData:n(C),"onUpdate:paginationData":l[6]||(l[6]=o=>_(C)?C.value=o:null),tableColumn:n(fe),tableData:n(Q),showIndex:!0,showSelection:!0,onSelectionChange:me,onGetTableData:R},{sizeofraw:a(({row:o})=>[p(te(n(ct)(o.sizeofraw).formatted),1)]),operation:a(({row:o})=>[e(L,{class:"box-item",effect:"dark",content:"预览",placement:"top"},{default:a(()=>[w(e(i,{link:"",type:"primary",icon:"View",onClick:f=>Le(o),loading:o.viewLoading},null,8,["onClick","loading"]),[[x,["document:list:view"]]])]),_:2},1024),e(L,{class:"box-item",effect:"dark",content:"下载",placement:"top"},{default:a(()=>[w(e(i,{link:"",type:"primary",icon:"Download",onClick:f=>Te(o)},null,8,["onClick"]),[[x,["document:list:download"]]])]),_:2},1024),e(L,{class:"box-item",effect:"dark",content:"修改",placement:"top"},{default:a(()=>[w(e(i,{link:"",type:"primary",icon:"Edit",onClick:f=>Ue(o)},null,8,["onClick"]),[[x,["document:list:edit"]]])]),_:2},1024),e(L,{class:"box-item",effect:"dark",content:"删除",placement:"top"},{default:a(()=>[w(e(i,{link:"",type:"danger",icon:"Delete",onClick:f=>ze(o)},null,8,["onClick"]),[[x,["document:list:remove"]]])]),_:2},1024),e(L,{class:"box-item",effect:"dark",content:"导入",placement:"top"},{default:a(()=>[w(e(i,{link:"",type:"success",icon:"Right",onClick:f=>$e(o)},null,8,["onClick"]),[[x,["document:list:import"]]])]),_:2},1024)]),_:1},8,["paginationData","tableColumn","tableData"])]),_:1})]),_:1})]),_:1},8,["horizontal"])]),_:1}),S("div",bt,[e(i,{type:"primary",plain:"",onClick:l[7]||(l[7]=o=>_(y)?y.value=!0:y=!0)},{default:a(()=>[p(" 新建知识库 ")]),_:1}),e(i,{class:"mt-m",type:"success",plain:"",onClick:l[8]||(l[8]=o=>_(b)?b.value=!0:b=!0)},{default:a(()=>[p(" 添加到知识库 ")]),_:1})]),e(dt,{visible:n(D),"onUpdate:visible":l[9]||(l[9]=o=>_(D)?D.value=o:D=o),title:n(A),treeSelectedItem:n(g),onRefreshList:E},null,8,["visible","title","treeSelectedItem"]),e(it,{visible:n(V),"onUpdate:visible":l[10]||(l[10]=o=>_(V)?V.value=o:V=o),treeSelectedItem:n(g),onRefreshList:h},null,8,["visible","treeSelectedItem"]),e(st,{visible:n(y),"onUpdate:visible":l[11]||(l[11]=o=>_(y)?y.value=o:y=o),treeSelectedItem:n(g),onRefreshList:l[12]||(l[12]=()=>{})},null,8,["visible","treeSelectedItem"]),e(rt,{visible:n(b),"onUpdate:visible":l[13]||(l[13]=o=>_(b)?b.value=o:b=o),treeSelectedItem:n(g),treeSelectedCheckbox:n(J),tableSelectedCheckbox:n(G),tableDataItem:n(N),addKnowledgeBaseType:n(j),onRefreshList:l[14]||(l[14]=()=>{})},null,8,["visible","treeSelectedItem","treeSelectedCheckbox","tableSelectedCheckbox","tableDataItem","addKnowledgeBaseType"]),e(ut,{visible:n(I),"onUpdate:visible":l[15]||(l[15]=o=>_(I)?I.value=o:I=o),tableDataItem:n(N),onRefreshList:h},null,8,["visible","tableDataItem"])])}}}),Lt=Fe(ht,[["__scopeId","data-v-9e0ba967"]]);export{Lt as default};
