import{_ as B,d as j,r as g,C as h,z as x,w as T,e as r,j as U,o as z,h as s,f as n,p as O,i as Z,n as y,Z as d}from"./index-ChCbqBtc.js";import{l as G}from"./lodash-DN9DU0YO.js";import{h as H,d as J}from"./index-BD3tVcmV.js";const K={class:"dialog-footer"},L={__name:"AddEditFolder",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"",validator:m=>["新增","修改"].includes(m)},treeSelectedItem:{type:Object,default:()=>({})}},emits:["update:visible","refresh-list"],setup(m,{emit:w}){const{proxy:P}=j(),t=m,f=w,c=g(!1),i=g(null),o=h({name:""}),S=h({name:[{required:!0,message:"请输入目录名称",trigger:"blur"},{min:2,max:10,message:"请输入2~10个字符",trigger:"blur"}]}),V=x(()=>t.title==="修改"),_=x(()=>t.title==="新增"),I=()=>{var e;(e=i.value)==null||e.resetFields(),o.name=""},u=()=>{f("update:visible",!1),I()},C=()=>{u()},M=()=>{var e;V.value&&((e=t.treeSelectedItem)!=null&&e.label)?o.name=G.cloneDeep(t.treeSelectedItem.label):o.name=""},A=()=>_.value?{folderName:o.name,parentId:t.treeSelectedItem.id}:{folderName:o.name,id:t.treeSelectedItem.id},D=()=>_.value?H:J,E=e=>{const{code:l,msg:a}=e;l===200?(d.success(a),u(),f("refresh-list")):d.error(a||"操作失败")},F=async()=>{try{c.value=!0;const e=A(),a=await D()(e);E(a)}catch(e){console.error("提交失败:",e),d.error("操作失败，请重试")}finally{setTimeout(()=>{c.value=!1},300)}},b=()=>{i.value&&i.value.validate(e=>{e?F():d.error("请检查表单输入")})};T(()=>t.visible,e=>{e&&M()},{immediate:!0});const R=()=>{b()};return(e,l)=>{const a=r("el-input"),k=r("el-form-item"),q=r("el-form"),v=r("el-button"),N=r("el-dialog");return z(),U(N,{title:t.title,modelValue:t.visible,"onUpdate:modelValue":l[1]||(l[1]=p=>t.visible=p),width:"660px","append-to-body":"","before-close":u},{footer:s(()=>[Z("div",K,[n(v,{onClick:C},{default:s(()=>[y("取消")]),_:1}),n(v,{type:"primary",onClick:b,loading:c.value},{default:s(()=>[y(" 确定 ")]),_:1},8,["loading"])])]),default:s(()=>[n(q,{ref_key:"formRef",ref:i,model:o,rules:S,"label-width":"100px",onSubmit:O(R,["prevent"])},{default:s(()=>[n(k,{label:"目录名称",prop:"name"},{default:s(()=>[n(a,{modelValue:o.name,"onUpdate:modelValue":l[0]||(l[0]=p=>o.name=p),placeholder:"请输入目录名称",maxlength:"10","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}},Y=B(L,[["__scopeId","data-v-4c5b4724"]]);export{Y as default};
